# 脚手架命令注册和执行过程开发

## 脚手架命令注册

## 第三章 高性能脚手架架构设计和缓存结构设计

## 第四章 通用npm 模块类 Package封装

### 脚手架命令本地调试功能支持

根据第三章设计好的架构设计图来进行改造，先将脚手架启动阶段要做的一系列事情封装到一个函数内，这里我们命名为prepare。

```javascript
// 准备阶段
async function prepare() {
    // 检查包的版本号
    checkPkgVersion()
    // 检查root启动
    checkRoot()
    // 检查用户主目录
    checkUserHome()
    // 检查环境变量
    checkEnv()
    // 检查cli是否最新版本
    await checkGlobalUpdate()
}
```

通过监听targetPath这个option，我们可以将program.tatgetPath这个值保存到环境变量上，这样就可以很轻松的在其他模块内取到这个值。

```javascript
// 指定targetPath
program.on('option:targetPath', function () {
    // 保存到process.env对象上 可以在其他模块中拿到
    process.env.CLI_TARGET_PATH = program.targetPath
})
```

## 补充：在自己电脑上如何配置多个公钥

**背景**
：因为疫情的原因，国际庄现在不让出门，我平时是用公司的电脑进行练习的，这次用自己的电脑来配置公钥，但是遇到一个问题：我们这个仓库是在github的，但是我另一个仓库是在gitee上面存放的，于是我使用现有的账号可以正常拉取、推送到github，但是推送到gitee的时候它告诉我说权限不足。

通过百度得知是有办法解决的，那就是在一台电脑上配置多个ssh-key，经过参考网上的教程，终于调通了，将这次经历记下来，如果你和我有一样的问题，希望能帮到你。
这里偷个懒，将教程的链接直接贴在这里了：[https://www.cnblogs.com/popfisher/p/5731232.html](https://www.cnblogs.com/popfisher/p/5731232.html)

